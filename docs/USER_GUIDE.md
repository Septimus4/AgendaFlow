# AgendaFlow User Guide

Welcome to the AgendaFlow User Guide! This document explains how to use the AgendaFlow service to discover events in Paris.

## Table of Contents

1. [Introduction](#introduction)
2. [Getting Started](#getting-started)
3. [Asking Questions](#asking-questions)
4. [Filtering Events](#filtering-events)
5. [Understanding the Response](#understanding-the-response)
6. [Troubleshooting](#troubleshooting)

## Introduction

AgendaFlow is an intelligent event discovery service for Paris. It uses advanced AI (Retrieval-Augmented Generation) to understand your natural language questions and find relevant events from the OpenAgenda database.

Unlike traditional search engines, you can ask AgendaFlow questions like you would ask a friend.

## Getting Started

Ensure the service is running (see [README.md](../README.md) for installation instructions).

The service is accessible via a REST API. You can interact with it using tools like `curl`, Postman, or by integrating it into your own application.

Base URL: `http://localhost:8000`

## Asking Questions

The main way to interact with AgendaFlow is through the `/ask` endpoint.

**Endpoint:** `POST /ask`

**Example Query:**

```json
{
  "question": "What can I do with my kids this weekend?"
}
```

### Types of Questions

AgendaFlow understands various types of questions:

*   **General Discovery:** "What's happening in Paris?"
*   **Specific Interests:** "Are there any jazz concerts?"
*   **Time-Based:** "What is there to do next Tuesday?"
*   **Location-Based:** "Events in the 11th arrondissement"
*   **Price-Based:** "Free events for tonight"
*   **Combined:** "Free jazz concerts in the Marais this weekend"

## Filtering Events

While AgendaFlow tries to understand filters from your question, you can also provide explicit filters to narrow down your search.

**Request Body Parameters:**

| Parameter | Type | Description | Example |
| :--- | :--- | :--- | :--- |
| `question` | String | **Required.** The natural language question. | "Concerts tonight" |
| `category` | String | Filter by event category. | "music", "theater", "exhibition", "kids" |
| `price` | String | Filter by price. | "free", "cheap" |
| `arrondissement` | Integer | Filter by Paris arrondissement (1-20). | 11 |
| `from_date` | String | Start date (ISO 8601). | "2023-12-25T00:00:00Z" |
| `to_date` | String | End date (ISO 8601). | "2023-12-31T23:59:59Z" |
| `language` | String | Preferred language for the answer. | "en", "fr" |

**Example with Filters:**

```json
{
  "question": "Any exhibitions?",
  "category": "exhibition",
  "price": "free",
  "arrondissement": 4
}
```

## Understanding the Response

The service returns a JSON object containing the answer and the raw event data.

**Response Structure:**

```json
{
  "answer": "Here are some free exhibitions in the 4th arrondissement...",
  "events": [
    {
      "title": "Exhibition Name",
      "start_datetime": "2023-12-01T10:00:00Z",
      "venue_name": "Museum Name",
      "city": "Paris",
      "arrondissement": "4e",
      "price": "Free",
      "url": "https://...",
      "categories": ["exhibition"]
    }
  ],
  "filters_applied": {
    "category": "exhibition",
    "price_constraint": "free",
    "arrondissement": 4
  }
}
```

*   **answer**: A natural language summary generated by the AI, highlighting the most relevant events.
*   **events**: A list of structured event objects found.
*   **filters_applied**: Shows which filters were understood from your question or explicitly provided.

## Troubleshooting

### "I couldn't find any events matching your criteria."

*   **Try broadening your search:** Remove specific filters like arrondissement or price.
*   **Check the date:** Ensure you are asking about dates where events are likely to be scheduled (e.g., not too far in the past or too far in the future).
*   **Check the index:** Ensure the event index has been built recently using the `/rebuild` endpoint.

### Service is slow

*   The first request might be slower as models are loaded into memory.
*   Complex queries requiring retrieval of many documents might take longer.

### "Index not loaded"

*   This means the server started but couldn't find the FAISS index.
*   Run the build script (`python scripts/build_index.py`) or call the `/rebuild` endpoint.
